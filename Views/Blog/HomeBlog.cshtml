@model IEnumerable<GreTutor.Models.Entities.BlogPost>

@{
    ViewData["Title"] = "Home Blog";
    Layout = "_Layout";
    var currentUser = ViewBag.CurrentUser as string;
}

<!-- Page Banner Start -->
@await Html.PartialAsync("_PageBannerStart")
<!-- Page Banner End -->

<!-- Blog Start -->
<div class="section section-padding mt-n10">
    <div class="container">

        <!-- Blog Wrapper Start -->
        <div class="blog-wrapper">
            <div class="row">
                @foreach (var blog in Model)
                {
                    var blogImageUrl = $"https://picsum.photos/seed/{blog.BlogId}/800/600";
                    var authorName = blog.User?.UserName ?? "Unknown";
                    var avatarUrl = $"https://ui-avatars.com/api/?name={Uri.EscapeDataString(authorName)}&background=random&color=random";

                    <div class="col-lg-4 col-md-6">

                        <!-- Single Blog Start -->
                        <div class="single-blog">
                            <div class="blog-image">
                                <a asp-action="Details" asp-route-id="@blog.BlogId">
                                    <img src="@blogImageUrl" alt="Blog">
                                </a>
                            </div>
                            <div class="blog-content">
                                <div class="blog-author">
                                    <div class="author">
                                        <div class="author-thumb">
                                            <a href="#">
                                                <img src="@avatarUrl" alt="Author">
                                            </a>
                                        </div>
                                        <div class="author-name">
                                            <a class="name" href="#">@(blog.User?.UserName ?? "Unknown")</a>
                                        </div>
                                    </div>
                                    <div class="tag">
                                        <a href="#">GreTutor</a>
                                    </div>
                                </div>

                                <h4 class="title">
                                    <a asp-action="Details" asp-route-id="@blog.BlogId">
                                        @Html.DisplayFor(modelItem => blog.Title)
                                    </a>
                                </h4>

                                <div class="blog-meta">
                                    <span>
                                        <i class="icofont-calendar"></i> @blog.Created.ToString("dd/MM/yyyy HH:mm")
                                    </span>
                                    <span>
                                        <i class="icofont-heart"></i>
                                    </span>
                                </div>

                                <div class="d-flex align-items-center gap-2">
                                    <a asp-action="Details" asp-route-id="@blog.BlogId" class="btn btn-secondary btn-hover-primary flex-grow-1">
                                        <i class="fas fa-eye"></i> Read More
                                    </a>

                                    @if (blog.User?.UserName == currentUser)
                                    {
                                        <div class="btn-group" role="group">
                                            <a asp-action="Edit" asp-route-id="@blog.BlogId" class="btn btn-warning">
                                                <i class="fas fa-edit"></i> Edit
                                            </a>
                                            <a asp-action="Delete" asp-route-id="@blog.BlogId" class="btn btn-danger">
                                                <i class="fas fa-trash-alt"></i> Delete
                                            </a>
                                        </div>
                                    }
                                </div>
                            </div>
                        </div>
                        <!-- Single Blog End -->

                    </div>
                }
            </div>
        </div>
        <!-- Blog Wrapper End -->

    </div>
</div>
<!-- Blog End -->
